{
  "note": "## Testing Challenges with File System Operations\n\nTesting the a24z-memory tool presents unique challenges due to its heavy reliance on file system operations and repository detection.\n\n**Main testing difficulties**:\n1. **File system mocking**: Need to mock `fs`, `path`, and `os` modules for consistent test behavior\n2. **Repository detection**: Tests need to simulate different repository structures\n3. **Path normalization**: Cross-platform path handling makes test setup complex\n4. **Atomic file operations**: Testing the temporary file + rename pattern safely\n\n**Current test approach**:\n- **Disabled tests**: Many file operation tests are currently disabled (`*.test.ts.disabled`)\n- **Mock-based testing**: Using Jest mocks for file system operations\n- **Integration tests**: Separate test files for different aspects (storage, retrieval, etc.)\n\n**Test patterns used**:\n```typescript\n// Mock file system\njest.mock('node:fs');\njest.mock('node:path');\n\n// Mock repository detection\njest.mock('../utils/pathNormalization', () => ({\n  normalizeRepositoryPath: jest.fn(),\n  getRepositoryName: jest.fn()\n}));\n```\n\n**Why tests are challenging**:\n- **Real file system**: Tool needs to actually create/read files\n- **Repository context**: Tests must run in a git repository context\n- **Path resolution**: Complex path normalization logic hard to mock\n- **Cross-platform**: Tests need to work on Windows, macOS, and Linux\n\n**Files involved**:\n- `tests/setup.ts` - Test configuration\n- `tests/core-mcp/store/notesStore.test.ts` - Storage tests\n- `tests/core-mcp/tools/*.test.ts` - Tool tests\n\n**Tags**: testing, gotcha, file-operations, debugging",
  "directoryPath": "/Users/griever/Developer/a24z-Memory",
  "anchors": ["tests/setup.ts", "tests/core-mcp/store/notesStore.test.ts"],
  "tags": ["testing"],
  "confidence": "high",
  "type": "gotcha",
  "metadata": {
    "toolVersion": "2.0.0",
    "createdBy": "create_repository_note_tool"
  },
  "id": "note-1755662102471-djct4l96s",
  "timestamp": 1755662102471
}
