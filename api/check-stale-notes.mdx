---
title: 'check_stale_notes'
description: 'Check for notes with stale anchors (file paths that no longer exist) in a repository'
---

# check_stale_notes

Check for notes with stale anchors (file paths that no longer exist) in a repository. This tool helps maintain the accuracy and relevance of the knowledge base by identifying notes that reference files or directories that have been deleted or moved.

## Overview

The `check_stale_notes` tool scans all notes in the repository and validates their anchor paths. It identifies notes that reference files or directories that no longer exist, helping you maintain the quality of your knowledge base.

<RequestExample>
```json
{
  "directoryPath": "/Users/project/my-app"
}
```
</RequestExample>

## Parameters

| Parameter       | Type   | Required | Description                                                              |
| --------------- | ------ | -------- | ------------------------------------------------------------------------ |
| `directoryPath` | string | Yes      | Absolute path to the git repository root directory or any path within it |

## Response Format

### No Stale Notes Found

```json
{
  "success": true,
  "message": "No stale notes found. All note anchors point to existing files."
}
```

### Stale Notes Found

```json
{
  "success": true,
  "message": "Found 2 note(s) with stale anchors:\n\n## Note ID: note-1734567890123-abc123def\nType: gotcha | Confidence: high\nTags: api, error-handling\n\nNote preview: When handling API errors, always provide user-friendly...\n\nStale anchors (1):\n  ❌ /src/api/deprecated-endpoint.ts\n\nValid anchors (2):\n  ✅ /src/api/client.ts\n  ✅ /src/components/ErrorBoundary.tsx\n---\n\n## Note ID: note-1734567890123-xyz789ghi\nType: pattern | Confidence: medium\nTags: testing, react\n\nNote preview: For component testing, use react-testing-library...\n\nStale anchors (1):\n  ❌ /src/components/legacy/Button.tsx\n\nValid anchors (0):\n---"
}
```

## Use Cases

### Maintenance and Cleanup

```json
{
  "directoryPath": "/Users/project/my-app"
}
```

**Purpose**: Regular maintenance to keep the knowledge base accurate and relevant.

### Before Major Refactoring

```json
{
  "directoryPath": "/Users/project/my-app/src/components"
}
```

**Purpose**: Check for notes that will become stale after planned file movements or deletions.

### Repository Health Check

```json
{
  "directoryPath": "/Users/project/my-app"
}
```

**Purpose**: Periodic audit of knowledge base quality and accuracy.

## Stale Anchor Types

### File-Level Anchors

- References to specific files that have been deleted
- Files that have been moved to different locations
- Files that have been renamed

### Directory-Level Anchors

- References to directories that no longer exist
- Directories that have been reorganized or moved
- Directory structures that have changed significantly

### Path Resolution Issues

- Symbolic links that are broken
- Relative paths that are no longer valid
- Absolute paths that don't match current repository structure

## Recommended Actions

### For Each Stale Note

1. **Review the note content** - Determine if it's still valuable
2. **Update anchor paths** - If the content is still relevant, update the paths
3. **Create new note** - If significant changes occurred, create a new note with correct anchors
4. **Remove if obsolete** - If the information is no longer relevant, consider deletion

### Best Practices

**Regular Checks**: Run stale note checks as part of your development workflow
**Pre-Refactoring**: Always check for stale notes before major code changes
**Team Communication**: Inform team members about potential stale notes after file movements
**Documentation Updates**: Update documentation references when files are moved

## Integration with AI Agents

AI agents should use this tool when:

1. **Starting new tasks** - Check if any notes will become stale
2. **After file operations** - Validate note anchors after moves/deletions
3. **Regular maintenance** - Include in periodic knowledge base health checks
4. **Before major changes** - Assess impact on existing documentation

## Related Tools

- **[askA24zMemory](/api/askA24zMemory)** - Query existing notes
- **[get_repository_note](/api/get-note-by-id)** - Get specific note details
- **[create_repository_note](/api/create-repository-note)** - Create updated notes

## Error Handling

### Repository Not Found

```json
{
  "success": false,
  "error": "directoryPath is not within a git repository: \"/Users/project/my-app\". Please provide a path within a git repository."
}
```

### Invalid Path

```json
{
  "success": false,
  "error": "directoryPath does not exist: \"/Users/project/my-app\". Please provide a valid absolute path to an existing directory."
}
```

### Permission Denied

```json
{
  "success": false,
  "error": "Permission denied accessing repository notes"
}
```

## Performance Considerations

### Large Repositories

For repositories with many notes:

- The tool scans all notes and validates each anchor path
- Performance scales with the number of notes and anchor complexity
- Consider running during low-activity periods

### Optimization Tips

- Use specific directory paths when possible (rather than repository root)
- Run checks during maintenance windows
- Consider automation for regular checks
